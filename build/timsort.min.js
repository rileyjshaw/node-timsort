!function(a,b){if("function"==typeof define&&define.amd)define("timsortAsync",["exports","regenerator-runtime/runtime"],b);else if("undefined"!=typeof exports)b(exports,require("regenerator-runtime/runtime"));else{var c={exports:{}};b(c.exports,a.runtime),a.timsortAsync=c.exports}}(this,function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}function d(a){for(var b=0;a>=g;)b|=1&a,a>>=1;return a+b}function e(a,b,c){for(c--;b<c;){var d=a[b];a[b++]=a[c],a[c--]=d}}Object.defineProperty(a,"__esModule",{value:!0}),a.sort=void 0;var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=32,h=7,i=256,j=function(){var a=c(regeneratorRuntime.mark(function a(b,c,d,f){var g;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(g=c+1,g!==d){a.next=3;break}return a.abrupt("return",1);case 3:return a.next=5,f(b[g++],b[c]);case 5:if(a.t0=a.sent,!(a.t0<0)){a.next=20;break}case 7:if(a.t1=g<d,!a.t1){a.next=13;break}return a.next=11,f(b[g],b[g-1]);case 11:a.t2=a.sent,a.t1=a.t2<0;case 13:if(!a.t1){a.next=17;break}g++,a.next=7;break;case 17:e(b,c,g),a.next=30;break;case 20:if(a.t3=g<d,!a.t3){a.next=26;break}return a.next=24,f(b[g],b[g-1]);case 24:a.t4=a.sent,a.t3=a.t4>=0;case 26:if(!a.t3){a.next=30;break}g++,a.next=20;break;case 30:return a.abrupt("return",g-c);case 31:case"end":return a.stop()}},a,this)}));return function(b,c,d,e){return a.apply(this,arguments)}}(),k=function(){var a=c(regeneratorRuntime.mark(function a(b,c,d,e,f){var g,h,i,j,k;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e===c&&e++;case 1:if(!(e<d)){a.next=30;break}g=b[e],h=c,i=e;case 5:if(!(h<i)){a.next=17;break}return j=h+i>>>1,a.next=9,f(g,b[j]);case 9:if(a.t0=a.sent,!(a.t0<0)){a.next=14;break}i=j,a.next=15;break;case 14:h=j+1;case 15:a.next=5;break;case 17:k=e-h,a.t1=k,a.next=3===a.t1?21:2===a.t1?22:1===a.t1?23:25;break;case 21:b[h+3]=b[h+2];case 22:b[h+2]=b[h+1];case 23:return b[h+1]=b[h],a.abrupt("break",26);case 25:for(;k>0;)b[h+k]=b[h+k-1],k--;case 26:b[h]=g;case 27:e++,a.next=1;break;case 30:case"end":return a.stop()}},a,this)}));return function(b,c,d,e,f){return a.apply(this,arguments)}}(),l=function(){var a=c(regeneratorRuntime.mark(function a(b,c,d,e,f,g){var h,i,j,k,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return h=0,i=0,j=1,a.next=5,g(b,c[d+f]);case 5:if(a.t0=a.sent,!(a.t0>0)){a.next=25;break}i=e-f;case 8:if(a.t1=j<i,!a.t1){a.next=14;break}return a.next=12,g(b,c[d+f+j]);case 12:a.t2=a.sent,a.t1=a.t2>0;case 14:if(!a.t1){a.next=20;break}h=j,j=(j<<1)+1,j<=0&&(j=i),a.next=8;break;case 20:j>i&&(j=i),h+=f,j+=f,a.next=42;break;case 25:i=f+1;case 26:if(a.t3=j<i,!a.t3){a.next=32;break}return a.next=30,g(b,c[d+f-j]);case 30:a.t4=a.sent,a.t3=a.t4<=0;case 32:if(!a.t3){a.next=38;break}h=j,j=(j<<1)+1,j<=0&&(j=i),a.next=26;break;case 38:j>i&&(j=i),k=h,h=f-j,j=f-k;case 42:h++;case 43:if(!(h<j)){a.next=55;break}return l=h+(j-h>>>1),a.next=47,g(b,c[d+l]);case 47:if(a.t5=a.sent,!(a.t5>0)){a.next=52;break}h=l+1,a.next=53;break;case 52:j=l;case 53:a.next=43;break;case 55:return a.abrupt("return",j);case 56:case"end":return a.stop()}},a,this)}));return function(b,c,d,e,f,g){return a.apply(this,arguments)}}(),m=function(){var a=c(regeneratorRuntime.mark(function a(b,c,d,e,f,g){var h,i,j,k,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return h=0,i=0,j=1,a.next=5,g(b,c[d+f]);case 5:if(a.t0=a.sent,!(a.t0<0)){a.next=26;break}i=f+1;case 8:if(a.t1=j<i,!a.t1){a.next=14;break}return a.next=12,g(b,c[d+f-j]);case 12:a.t2=a.sent,a.t1=a.t2<0;case 14:if(!a.t1){a.next=20;break}h=j,j=(j<<1)+1,j<=0&&(j=i),a.next=8;break;case 20:j>i&&(j=i),k=h,h=f-j,j=f-k,a.next=42;break;case 26:i=e-f;case 27:if(a.t3=j<i,!a.t3){a.next=33;break}return a.next=31,g(b,c[d+f+j]);case 31:a.t4=a.sent,a.t3=a.t4>=0;case 33:if(!a.t3){a.next=39;break}h=j,j=(j<<1)+1,j<=0&&(j=i),a.next=27;break;case 39:j>i&&(j=i),h+=f,j+=f;case 42:h++;case 43:if(!(h<j)){a.next=55;break}return l=h+(j-h>>>1),a.next=47,g(b,c[d+l]);case 47:if(a.t5=a.sent,!(a.t5<0)){a.next=52;break}j=l,a.next=53;break;case 52:h=l+1;case 53:a.next=43;break;case 55:return a.abrupt("return",j);case 56:case"end":return a.stop()}},a,this)}));return function(b,c,d,e,f,g){return a.apply(this,arguments)}}(),n=function(){function a(c,d){b(this,a),this.array=null,this.compare=null,this.minGallop=h,this.length=0,this.tmpStorageLength=i,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=c,this.compare=d,this.length=c.length,this.length<2*i&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return f(a,[{key:"pushRun",value:function(a,b){this.runStart[this.stackSize]=a,this.runLength[this.stackSize]=b,this.stackSize+=1}},{key:"mergeRuns",value:function(){function a(){return b.apply(this,arguments)}var b=c(regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(this.stackSize>1)){a.next=12;break}if(b=this.stackSize-2,!(b>=1&&this.runLength[b-1]<=this.runLength[b]+this.runLength[b+1]||b>=2&&this.runLength[b-2]<=this.runLength[b]+this.runLength[b-1])){a.next=6;break}this.runLength[b-1]<this.runLength[b+1]&&b--,a.next=8;break;case 6:if(!(this.runLength[b]>this.runLength[b+1])){a.next=8;break}return a.abrupt("break",12);case 8:return a.next=10,this.mergeAt(b);case 10:a.next=0;break;case 12:case"end":return a.stop()}},a,this)}));return a}()},{key:"forceMergeRuns",value:function(){function a(){return b.apply(this,arguments)}var b=c(regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(this.stackSize>1)){a.next=7;break}return b=this.stackSize-2,b>0&&this.runLength[b-1]<this.runLength[b+1]&&b--,a.next=5,this.mergeAt(b);case 5:a.next=0;break;case 7:case"end":return a.stop()}},a,this)}));return a}()},{key:"mergeAt",value:function(){function a(a){return b.apply(this,arguments)}var b=c(regeneratorRuntime.mark(function a(b){var c,d,e,f,g,h,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=this.compare,d=this.array,e=this.runStart[b],f=this.runLength[b],g=this.runStart[b+1],h=this.runLength[b+1],this.runLength[b]=f+h,b===this.stackSize-3&&(this.runStart[b+1]=this.runStart[b+2],this.runLength[b+1]=this.runLength[b+2]),this.stackSize--,a.next=11,m(d[g],d,e,f,0,c);case 11:if(i=a.sent,e+=i,f-=i,0!==f){a.next=16;break}return a.abrupt("return");case 16:return a.next=18,l(d[e+f-1],d,g,h,h-1,c);case 18:if(h=a.sent,0!==h){a.next=21;break}return a.abrupt("return");case 21:if(!(f<=h)){a.next=26;break}return a.next=24,this.mergeLow(e,f,g,h);case 24:a.next=28;break;case 26:return a.next=28,this.mergeHigh(e,f,g,h);case 28:case"end":return a.stop()}},a,this)}));return a}()},{key:"mergeLow",value:function(){function a(a,c,d,e){return b.apply(this,arguments)}var b=c(regeneratorRuntime.mark(function a(b,c,d,e){var f,g,i,j,k,n,o,p,q,r,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(f=this.compare,g=this.array,i=this.tmp,j=0,j=0;j<c;j++)i[j]=g[b+j];if(k=0,n=d,o=b,g[o++]=g[n++],0!==--e){a.next=12;break}for(j=0;j<c;j++)g[o+j]=i[k+j];return a.abrupt("return");case 12:if(1!==c){a.next=16;break}for(j=0;j<e;j++)g[o+j]=g[n+j];return g[o+e]=i[k],a.abrupt("return");case 16:p=this.minGallop;case 17:q=0,r=0,s=!1;case 21:return a.next=23,f(g[n],i[k]);case 23:if(a.t0=a.sent,!(a.t0<0)){a.next=33;break}if(g[o++]=g[n++],r++,q=0,0!==--e){a.next=31;break}return s=!0,a.abrupt("break",40);case 31:a.next=39;break;case 33:if(g[o++]=i[k++],q++,r=0,1!==--c){a.next=39;break}return s=!0,a.abrupt("break",40);case 39:if((q|r)<p){a.next=21;break}case 40:if(!s){a.next=42;break}return a.abrupt("break",80);case 42:return a.next=44,m(g[n],i,k,c,0,f);case 44:if(q=a.sent,0===q){a.next=53;break}for(j=0;j<q;j++)g[o+j]=i[k+j];if(o+=q,k+=q,c-=q,!(c<=1)){a.next=53;break}return s=!0,a.abrupt("break",74);case 53:if(g[o++]=g[n++],0!==--e){a.next=57;break}return s=!0,a.abrupt("break",74);case 57:return a.next=59,l(i[k],g,n,e,0,f);case 59:if(r=a.sent,0===r){a.next=68;break}for(j=0;j<r;j++)g[o+j]=g[n+j];if(o+=r,n+=r,e-=r,0!==e){a.next=68;break}return s=!0,a.abrupt("break",74);case 68:if(g[o++]=i[k++],1!==--c){a.next=72;break}return s=!0,a.abrupt("break",74);case 72:p--;case 73:if(q>=h||r>=h){a.next=42;break}case 74:if(!s){a.next=76;break}return a.abrupt("break",80);case 76:p<0&&(p=0),p+=2,a.next=17;break;case 80:if(this.minGallop=p,p<1&&(this.minGallop=1),1!==c){a.next=87;break}for(j=0;j<e;j++)g[o+j]=g[n+j];g[o+e]=i[k],a.next=92;break;case 87:if(0!==c){a.next=91;break}throw new Error("mergeLow preconditions were not respected");case 91:for(j=0;j<c;j++)g[o+j]=i[k+j];case 92:case"end":return a.stop()}},a,this)}));return a}()},{key:"mergeHigh",value:function(){function a(a,c,d,e){return b.apply(this,arguments)}var b=c(regeneratorRuntime.mark(function a(b,c,d,e){var f,g,i,j,k,n,o,p,q,r,s,t,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(f=this.compare,g=this.array,i=this.tmp,j=0,j=0;j<e;j++)i[j]=g[d+j];if(k=b+c-1,n=e-1,o=d+e-1,p=0,q=0,g[o--]=g[k--],0!==--c){a.next=15;break}for(p=o-(e-1),j=0;j<e;j++)g[p+j]=i[j];return a.abrupt("return");case 15:if(1!==e){a.next=23;break}for(o-=c,k-=c,q=o+1,p=k+1,j=c-1;j>=0;j--)g[q+j]=g[p+j];return g[o]=i[n],a.abrupt("return");case 23:r=this.minGallop;case 24:s=0,t=0,u=!1;case 28:return a.next=30,f(i[n],g[k]);case 30:if(a.t0=a.sent,!(a.t0<0)){a.next=40;break}if(g[o--]=g[k--],s++,t=0,0!==--c){a.next=38;break}return u=!0,a.abrupt("break",47);case 38:a.next=46;break;case 40:if(g[o--]=i[n--],t++,s=0,1!==--e){a.next=46;break}return u=!0,a.abrupt("break",47);case 46:if((s|t)<r){a.next=28;break}case 47:if(!u){a.next=49;break}return a.abrupt("break",95);case 49:return a.t1=c,a.next=52,m(i[n],g,b,c,c-1,f);case 52:if(a.t2=a.sent,s=a.t1-a.t2,0===s){a.next=64;break}for(o-=s,k-=s,c-=s,q=o+1,p=k+1,j=s-1;j>=0;j--)g[q+j]=g[p+j];if(0!==c){a.next=64;break}return u=!0,a.abrupt("break",89);case 64:if(g[o--]=i[n--],1!==--e){a.next=68;break}return u=!0,a.abrupt("break",89);case 68:return a.t3=e,a.next=71,l(g[k],i,0,e,e-1,f);case 71:if(a.t4=a.sent,t=a.t3-a.t4,0===t){a.next=83;break}for(o-=t,n-=t,e-=t,q=o+1,p=n+1,j=0;j<t;j++)g[q+j]=i[p+j];if(!(e<=1)){a.next=83;break}return u=!0,a.abrupt("break",89);case 83:if(g[o--]=g[k--],0!==--c){a.next=87;break}return u=!0,a.abrupt("break",89);case 87:r--;case 88:if(s>=h||t>=h){a.next=49;break}case 89:if(!u){a.next=91;break}return a.abrupt("break",95);case 91:r<0&&(r=0),r+=2,a.next=24;break;case 95:if(this.minGallop=r,r<1&&(this.minGallop=1),1!==e){a.next=106;break}for(o-=c,k-=c,q=o+1,p=k+1,j=c-1;j>=0;j--)g[q+j]=g[p+j];g[o]=i[n],a.next=112;break;case 106:if(0!==e){a.next=110;break}throw new Error("mergeHigh preconditions were not respected");case 110:for(p=o-(e-1),j=0;j<e;j++)g[p+j]=i[j];case 112:case"end":return a.stop()}},a,this)}));return a}()}]),a}();a.sort=function(){var a=c(regeneratorRuntime.mark(function a(b,c){var e,f,h,i,l,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.length;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(Array.isArray(b)){a.next=2;break}throw new TypeError("Can only sort arrays");case 2:if(e=o-m,!(e<2)){a.next=5;break}return a.abrupt("return");case 5:if(f=0,!(e<g)){a.next=13;break}return a.next=9,j(b,m,o,c);case 9:return f=a.sent,a.next=12,k(b,m,o,m+f,c);case 12:return a.abrupt("return");case 13:h=new n(b,c),i=d(e);case 15:return a.next=17,j(b,m,o,c);case 17:if(f=a.sent,!(f<i)){a.next=24;break}return l=e,l>i&&(l=i),a.next=23,k(b,m,m+l,m+f,c);case 23:f=l;case 24:return h.pushRun(m,f),a.next=27,h.mergeRuns();case 27:e-=f,m+=f;case 29:if(0!==e){a.next=15;break}case 30:return a.next=32,h.forceMergeRuns();case 32:case"end":return a.stop()}},a,this)}));return function(b,c){return a.apply(this,arguments)}}()});